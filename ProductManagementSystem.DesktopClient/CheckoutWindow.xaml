<Window x:Class="ProductManagementSystem.DesktopClient.CheckoutWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Checkout" Height="820" Width="950"
        WindowStartupLocation="CenterScreen" WindowStyle="None" AllowsTransparency="True" Background="Transparent"
        Icon="pack://application:,,,/Assets/icon.png"
        MouseDown="Window_MouseDown">
    <Border CornerRadius="12" Background="#f8fafc">
        <Border.Effect>
            <DropShadowEffect BlurRadius="15" ShadowDepth="3" Opacity="0.1" Color="#000000"/>
        </Border.Effect>

        <Grid Margin="22">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="340"/>
            </Grid.ColumnDefinitions>


            <Grid Grid.Column="0" Margin="0,0,12,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>


                <Grid Grid.Row="0" Margin="0,0,0,12">
                    <TextBlock x:Name="txtTitle" Text="Checkout" FontSize="22" FontWeight="Bold" Foreground="#1e293b" VerticalAlignment="Center"/>
                    <Button HorizontalAlignment="Right" Background="Transparent" Foreground="#ef4444" BorderBrush="Transparent" Click="Close_Click" Cursor="Hand">
                        <md:PackIcon Kind="Close" Width="24" Height="24"/>
                    </Button>
                </Grid>


                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <ItemsControl x:Name="listCart">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="White" CornerRadius="10" Margin="0,0,0,6" Padding="10" BorderThickness="1" BorderBrush="#e2e8f0">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="46"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <Border Grid.Column="0" Width="40" Height="40" CornerRadius="6" ClipToBounds="True">
                                            <Image Source="{Binding ProxyImageUrl}" Stretch="UniformToFill" RenderOptions.BitmapScalingMode="HighQuality"/>
                                        </Border>
                                        <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="8,0,0,0">
                                            <TextBlock Text="{Binding Nome}" FontSize="13" Foreground="#1e293b" FontWeight="SemiBold"/>
                                            <TextBlock Text="{Binding FormattedUnitPrice}" FontSize="11" Foreground="#64748b"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" Margin="8,0,8,0">
                                            <Button Width="26" Height="26" Background="#f1f5f9" Foreground="#334155" BorderThickness="0" md:ButtonAssist.CornerRadius="13" Padding="0" Click="DecreaseQty_Click" Tag="{Binding}" Cursor="Hand">
                                                <md:PackIcon Kind="Minus" Width="12" Height="12"/>
                                            </Button>
                                            <TextBlock Text="{Binding Quantity}" FontSize="15" Foreground="#1e293b" FontWeight="Bold" VerticalAlignment="Center" Margin="10,0" MinWidth="18" TextAlignment="Center"/>
                                            <Button Width="26" Height="26" Background="#e6570a" Foreground="White" BorderThickness="0" md:ButtonAssist.CornerRadius="13" Padding="0" Click="IncreaseQty_Click" Tag="{Binding}" Cursor="Hand">
                                                <md:PackIcon Kind="Plus" Width="12" Height="12"/>
                                            </Button>
                                        </StackPanel>
                                        <TextBlock Grid.Column="3" Text="{Binding FormattedSubtotal}" FontSize="14" Foreground="#16a34a" FontWeight="Bold" VerticalAlignment="Center" MinWidth="75" TextAlignment="Right"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>


                <Border Grid.Row="2" Background="White" CornerRadius="10" BorderBrush="#e2e8f0" BorderThickness="1" Padding="14" Margin="0,8,0,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Row="0" Grid.Column="0" x:Name="lblSubtotal" Text="Subtotal:" Foreground="#64748b" FontSize="12"/>
                        <TextBlock Grid.Row="0" Grid.Column="1" x:Name="txtSubtotal" Text="R$ 0,00" Foreground="#475569" FontSize="12" HorizontalAlignment="Right"/>
                        <TextBlock Grid.Row="1" Grid.Column="0" x:Name="lblItems" Text="Itens:" Foreground="#64748b" FontSize="12" Margin="0,3,0,0"/>
                        <TextBlock Grid.Row="1" Grid.Column="1" x:Name="txtItemCount" Text="0" Foreground="#475569" FontSize="12" HorizontalAlignment="Right" Margin="0,3,0,0"/>
                        <TextBlock Grid.Row="2" Grid.Column="0" x:Name="lblDiscount" Text="" Foreground="#16a34a" FontSize="12" Margin="0,3,0,0"/>
                        <TextBlock Grid.Row="2" Grid.Column="1" x:Name="txtDiscount" Text="" Foreground="#16a34a" FontSize="12" HorizontalAlignment="Right" Margin="0,3,0,0"/>
                        <Border Grid.Row="3" Grid.ColumnSpan="2" BorderThickness="0,1,0,0" BorderBrush="#e2e8f0" Margin="0,6,0,0" Padding="0,6,0,0">
                            <Grid>
                                <TextBlock x:Name="lblTotal" Text="TOTAL:" Foreground="#1e293b" FontSize="17" FontWeight="Bold"/>
                                <TextBlock x:Name="txtTotal" Text="R$ 0,00" Foreground="#16a34a" FontSize="20" FontWeight="Bold" HorizontalAlignment="Right"/>
                            </Grid>
                        </Border>
                    </Grid>
                </Border>
            </Grid>


            <ScrollViewer Grid.Column="1" Margin="12,0,0,0" VerticalScrollBarVisibility="Auto">
                <StackPanel>

                    <Border Background="White" CornerRadius="10" Padding="14" Margin="0,0,0,8" BorderThickness="1" BorderBrush="#e2e8f0">
                        <StackPanel>
                            <TextBlock x:Name="lblCustomer" Text="Cliente" FontSize="13" FontWeight="Bold" Foreground="#1e293b" Margin="0,0,0,8"/>
                            <TextBox x:Name="txtCustomerName" md:HintAssist.Hint="Nome do Cliente" Style="{StaticResource MaterialDesignFloatingHintTextBox}" Foreground="#1e293b" md:HintAssist.Foreground="#64748b" md:TextFieldAssist.UnderlineBrush="#e6570a" FontSize="12" Margin="0,0,0,6"/>
                            <TextBox x:Name="txtEmail" md:HintAssist.Hint="Email para Recibo" Style="{StaticResource MaterialDesignFloatingHintTextBox}" Foreground="#1e293b" md:HintAssist.Foreground="#64748b" md:TextFieldAssist.UnderlineBrush="#e6570a" FontSize="12"/>
                        </StackPanel>
                    </Border>


                    <Border Background="White" CornerRadius="10" Padding="14" Margin="0,0,0,8" BorderThickness="1" BorderBrush="#e2e8f0">
                        <StackPanel>
                            <TextBlock x:Name="lblPayment" Text="Pagamento" FontSize="13" FontWeight="Bold" Foreground="#1e293b" Margin="0,0,0,10"/>
                            <RadioButton x:Name="rbPix" GroupName="Payment" Margin="0,0,0,6" Foreground="#1e293b" Checked="PaymentMethod_Changed">
                                <StackPanel Orientation="Horizontal">
                                    <md:PackIcon Kind="QrcodeScan" Width="16" Height="16" Foreground="#16a34a" Margin="0,0,6,0"/>
                                    <TextBlock Text="PIX" FontSize="12" FontWeight="SemiBold" Foreground="#1e293b"/>
                                    <TextBlock x:Name="lblPixDiscount" Text=" (5% desc.)" FontSize="10" Foreground="#16a34a"/>
                                </StackPanel>
                            </RadioButton>
                            <RadioButton x:Name="rbCredit" GroupName="Payment" Margin="0,0,0,6" Foreground="#1e293b" Checked="PaymentMethod_Changed">
                                <StackPanel Orientation="Horizontal">
                                    <md:PackIcon Kind="CreditCardOutline" Width="16" Height="16" Foreground="#4f46e5" Margin="0,0,6,0"/>
                                    <TextBlock x:Name="lblCreditCard" Text="Cartão Crédito" FontSize="12" FontWeight="SemiBold" Foreground="#1e293b"/>
                                </StackPanel>
                            </RadioButton>
                            <RadioButton x:Name="rbDebit" GroupName="Payment" Margin="0,0,0,6" Foreground="#1e293b" Checked="PaymentMethod_Changed">
                                <StackPanel Orientation="Horizontal">
                                    <md:PackIcon Kind="CreditCardChipOutline" Width="16" Height="16" Foreground="#0284c7" Margin="0,0,6,0"/>
                                    <TextBlock x:Name="lblDebitCard" Text="Cartão Débito" FontSize="12" FontWeight="SemiBold" Foreground="#1e293b"/>
                                </StackPanel>
                            </RadioButton>
                            <RadioButton x:Name="rbCash" GroupName="Payment" Foreground="#1e293b" Checked="PaymentMethod_Changed">
                                <StackPanel Orientation="Horizontal">
                                    <md:PackIcon Kind="Cash" Width="16" Height="16" Foreground="#ea580c" Margin="0,0,6,0"/>
                                    <TextBlock x:Name="lblCash" Text="Dinheiro" FontSize="12" FontWeight="SemiBold" Foreground="#1e293b"/>
                                </StackPanel>
                            </RadioButton>
                        </StackPanel>
                    </Border>


                    <Border x:Name="panelPix" Background="White" CornerRadius="10" Padding="14" Margin="0,0,0,8" Visibility="Collapsed" BorderThickness="1" BorderBrush="#e2e8f0">
                        <StackPanel HorizontalAlignment="Center">
                            <TextBlock x:Name="lblPixInfo" Text="Escaneie para pagar" FontSize="12" FontWeight="SemiBold" Foreground="#1e293b" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                            <Border Background="White" CornerRadius="8" Padding="6" HorizontalAlignment="Center" BorderThickness="1" BorderBrush="#e2e8f0">
                                <Image x:Name="imgQrCode" Width="160" Height="160" Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </Border>
                            <TextBlock x:Name="txtPixTotal" Text="" Foreground="#16a34a" FontSize="15" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                            <TextBlock x:Name="txtPixKey" Text="" Foreground="#64748b" FontSize="10" HorizontalAlignment="Center" Margin="0,4,0,0" TextWrapping="Wrap" TextAlignment="Center"/>
                        </StackPanel>
                    </Border>


                    <Border x:Name="panelCard" Background="White" CornerRadius="10" Padding="14" Margin="0,0,0,8" Visibility="Collapsed" BorderThickness="1" BorderBrush="#e2e8f0">
                        <StackPanel>
                            <TextBlock x:Name="lblCardInfo" Text="Dados do Cartão" FontSize="12" FontWeight="SemiBold" Foreground="#1e293b" Margin="0,0,0,8"/>
                            <TextBox x:Name="txtCardNumber" md:HintAssist.Hint="Número do Cartão" Style="{StaticResource MaterialDesignFloatingHintTextBox}" Foreground="#1e293b" md:HintAssist.Foreground="#64748b" md:TextFieldAssist.UnderlineBrush="#4f46e5" FontSize="13" MaxLength="19" TextChanged="CardNumber_Changed" Margin="0,0,0,4"/>
                            <TextBox x:Name="txtCardHolder" md:HintAssist.Hint="Nome no Cartão" Style="{StaticResource MaterialDesignFloatingHintTextBox}" Foreground="#1e293b" md:HintAssist.Foreground="#64748b" md:TextFieldAssist.UnderlineBrush="#4f46e5" FontSize="12" Margin="0,0,0,4"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="10"/>
                                    <ColumnDefinition Width="80"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Grid.Column="0" x:Name="txtCardExpiry" md:HintAssist.Hint="MM/AA" Style="{StaticResource MaterialDesignFloatingHintTextBox}" Foreground="#1e293b" md:HintAssist.Foreground="#64748b" md:TextFieldAssist.UnderlineBrush="#4f46e5" FontSize="12" MaxLength="5" TextChanged="CardExpiry_Changed"/>
                                <TextBox Grid.Column="2" x:Name="txtCardCVV" md:HintAssist.Hint="CVV" Style="{StaticResource MaterialDesignFloatingHintTextBox}" Foreground="#1e293b" md:HintAssist.Foreground="#64748b" md:TextFieldAssist.UnderlineBrush="#4f46e5" FontSize="12" MaxLength="4"/>
                            </Grid>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,14,0,0">
                                <Button x:Name="rbVisa" Background="#f8fafc" BorderBrush="#cbd5e1" BorderThickness="2" Padding="12,5" Margin="0,0,8,0" md:ButtonAssist.CornerRadius="6" Click="CardBrand_Click" Cursor="Hand">
                                    <TextBlock Text="VISA" Foreground="#1A1F71" FontSize="12" FontWeight="Bold"/>
                                </Button>
                                <Button x:Name="rbMaster" Background="#f8fafc" BorderBrush="#cbd5e1" BorderThickness="2" Padding="12,5" Margin="0,0,8,0" md:ButtonAssist.CornerRadius="6" Click="CardBrand_Click" Cursor="Hand">
                                    <TextBlock Text="MC" Foreground="#EB001B" FontSize="12" FontWeight="Bold"/>
                                </Button>
                                <Button x:Name="rbElo" Background="#f8fafc" BorderBrush="#cbd5e1" BorderThickness="2" Padding="12,5" md:ButtonAssist.CornerRadius="6" Click="CardBrand_Click" Cursor="Hand">
                                    <TextBlock Text="ELO" Foreground="#00A4E0" FontSize="12" FontWeight="Bold"/>
                                </Button>
                            </StackPanel>
                        </StackPanel>
                    </Border>


                    <Border x:Name="panelCash" Background="White" CornerRadius="10" Padding="14" Margin="0,0,0,8" Visibility="Collapsed" BorderThickness="1" BorderBrush="#e2e8f0">
                        <StackPanel>
                            <TextBlock x:Name="lblCashReceived" Text="Valor Recebido" FontSize="12" FontWeight="SemiBold" Foreground="#1e293b" Margin="0,0,0,6"/>
                            <TextBox x:Name="txtCashAmount" md:HintAssist.Hint="R$ 0,00" Style="{StaticResource MaterialDesignFloatingHintTextBox}" Foreground="#1e293b" md:HintAssist.Foreground="#64748b" md:TextFieldAssist.UnderlineBrush="#ea580c" FontSize="15" TextChanged="CashAmount_Changed"/>
                            <Border Background="#f8fafc" CornerRadius="8" Margin="0,10,0,0" Padding="10">
                                <Grid>
                                    <TextBlock x:Name="lblChange" Text="Troco:" Foreground="#64748b" FontSize="11" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtChange" Text="R$ 0,00" Foreground="#ea580c" FontSize="17" FontWeight="Bold" HorizontalAlignment="Right"/>
                                </Grid>
                            </Border>
                        </StackPanel>
                    </Border>


                    <Border x:Name="panelSignature" Background="White" CornerRadius="10" Padding="14" Margin="0,0,0,8" Visibility="Collapsed" BorderThickness="1" BorderBrush="#e2e8f0">
                        <StackPanel>
                            <TextBlock x:Name="txtSigLabel" Text="Assinatura Digital (SHA256)" Foreground="#e6570a" FontSize="11" FontWeight="Bold"/>
                            <TextBlock x:Name="txtSignature" Text="" Foreground="#475569" FontFamily="Consolas" FontSize="9" Margin="0,6,0,0" TextWrapping="Wrap"/>
                            <Border BorderThickness="0,1,0,0" BorderBrush="#e2e8f0" Margin="0,8,0,0" Padding="0,8,0,0">
                                <StackPanel>
                                    <TextBlock x:Name="lblOrderId" Text="" Foreground="#64748b" FontSize="10"/>
                                    <TextBlock x:Name="lblOrderDate" Text="" Foreground="#64748b" FontSize="10" Margin="0,2,0,0"/>
                                    <TextBlock x:Name="lblEmailSent" Text="" Foreground="#16a34a" FontSize="10" Margin="0,2,0,0"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>


                    <TextBlock x:Name="txtStatus" Foreground="#dc2626" TextWrapping="Wrap" FontSize="11" Margin="0,0,0,6" HorizontalAlignment="Center"/>
                    <Button x:Name="btnCheckout" Content="FINALIZAR COMPRA" Background="#e6570a" Foreground="White" BorderThickness="0" Height="46" FontSize="14" FontWeight="Bold" md:ButtonAssist.CornerRadius="10" Click="Checkout_Click" Padding="16,0" Cursor="Hand">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="10">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#cc4a08"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </Border>
</Window>
